{% extends "base.html" %}
{% block title %}Feed{% endblock %}
{% block content %}

<div class="episodes mt-2 mx-2" style="max-width: 500px; position: relative;">
  <div class="sticky-footer"
    style="position: sticky; top: 0; background: #fff; padding: 10px; display: flex; justify-content: space-between;">
    <a href="/subscriptions" style="display: inline-block;">
      Subscriptions
    </a>
    <a href="/settings" style="display: inline-block;">
      Settings
    </a>
    <a href="/logs" style="display: inline-block;">
      Logs
    </a>
  </div>
  {% for episode in episodes %}
  <div class="episode-preview mb-1" id="{{episode.pk}}" style="max-height: 150px; border-bottom: 1px solid #ccc;">
    <div class="image-container">
      <img src="{{ episode.image_url }}" alt="" width="125" />
    </div>
    <div class="text-content" style="white-space: nowrap;">
      <div id="episode-title-{{episode.pk}}">
        {{ episode.title }}
      </div>
      Published: {{ episode.pub_date }}
      <a href="{{episode.media_link}}" class="btn btn-link">Source</a>
      <br />
      {% if episode.audio_url %}
      <audio controls>
        <source src="{{episode.audio_url}}" type="audio/mpeg">
        Your browser does not support the audio element.
      </audio>
      {% else %}
      <form action="{% url 'add_to_rss_episode_download_queue' episode.pk %}" method="POST" class="d-inline">
        {% csrf_token %}
        <button type="submit" class="btn btn-primary">Download</button>
      </form>
      {% endif %}
      <form action="{% url 'hide_episode' episode.pk %}" method="POST" class="d-inline">
        {% csrf_token %}
        <button type="submit" class="btn btn-danger" onclick="hide('{{episode.pk}}')">Hide</button>
      </form>
    </div>
  </div>
  {% endfor %}
  <div class="sticky-footer"
    style="position: sticky; bottom: 0; background: #fff; padding: 10px; display: flex; justify-content: space-between;">
    <form action="{% url 'hide_all_episodes' %}" method="POST" style="display: inline-block;">
      {% csrf_token %}
      <button type="submit">Hide All</button>
    </form>
    <form action="{% url 'toggle_feed_chronological' %}" method="POST" style="display: inline-block;">
      {% csrf_token %}
      <button type="submit">Toggle Chron</button>
    </form>
    <form action="{% url 'refresh_subscriptions' %}" method="POST" style="display: inline-block;">
      {% csrf_token %}
      <button type="submit">Refresh</button>
    </form>
  </div>
</div>
{% endblock %}