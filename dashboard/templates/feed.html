{% extends "base.html" %}
{% block title %}Feed{% endblock %}
{% block content %}

<div class="sticky-header"
  style="position: sticky; top: 0; background: #fff; padding: 10px; display: flex; justify-content: space-between;">
 <button type="button" class="btn btn-secondary" onclick="hideAll('{% url "hide_all_episodes" %}')">Hide All</button>
 <button type="button" class="btn btn-secondary" onclick="toggleChron('{% url "toggle_feed_chronological" %}')">Toggle Chron</button>
 <button type="button" class="btn btn-secondary" onclick="refreshFeed('{% url "refresh_subscriptions" %}')">Refresh</button>
</div>

<div id="episode-previews">
{% for episode in episodes %}
<div class="episode-preview mb-1" id="{{episode.pk}}" style="max-height: 150px; border-bottom: 1px solid #ccc;">
  <div class="image-container">
    <img src="{{ episode.image_url }}" alt="" width="125" />
  </div>
  <div class="text-content" style="white-space: nowrap;">
    <div id="episode-title-{{episode.pk}}">
      {{ episode.title }}
    </div>
    Published: {{ episode.pub_date }}
    <a href="{{episode.media_link}}" class="btn btn-link">Source</a>
    <br />

    {% if episode.audio_url %}
    <button type="button" class="btn btn-primary" onclick="playEpisode('{% url "play_episode" episode.pk %}', {{episode.pk}})">Play</button>
    
    {% elif episode.queued_for_download %}
    <button id="episode-download-btn-{{episode.pk}}" type="button" class="btn btn-primary" onclick="downloadEpisode('{% url "add_to_rss_episode_download_queue" episode.pk %}', {{episode.pk}})" disabled="true">Queued</button>
    {% else %}
    <button id="episode-download-btn-{{episode.pk}}" type="button" class="btn btn-primary" onclick="downloadEpisode('{% url "add_to_rss_episode_download_queue" episode.pk %}', {{episode.pk}})">Download</button>
    {% endif %}

    <button type="button" class="btn btn-danger" onclick="hideEpisode('{% url "hide_episode" episode.pk %}', {{episode.pk}})">Hide</button>
  </div>
</div>
{% endfor %}
</div>

<div class="sticky-header"
  style="position: sticky; bottom: 0; background: #fff; padding: 10px; display: flex; flex-direction: column; justify-content: space-between;">
  <div>{{ player_episode.title }} - {{player_episode.pub_date}}</div>
  <audio id= "player-audio" controls>
    <source src="{{ player_episode.audio_url }}" type="audio/mpeg">
    Your browser does not support the audio element.
  </audio>
</div>
{% endblock %}
